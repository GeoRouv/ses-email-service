<div id="domain-list">
    {% for domain in domains %}
    <div id="domain-card-{{ domain.id }}" class="bg-white rounded-lg shadow p-6 mb-4">
        <div class="flex items-center justify-between mb-4">
            <div>
                <h3 class="text-lg font-semibold text-gray-800">{{ domain.domain }}</h3>
                <p class="text-xs text-gray-400 mt-0.5">Added {{ domain.created_at.strftime('%b %d, %Y') }}</p>
            </div>
            <div class="flex items-center space-x-3">
                <!-- Verification Status -->
                {% if domain.verification_status == 'Success' %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Verified</span>
                {% elif domain.verification_status == 'Pending' %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Pending</span>
                {% elif domain.verification_status == 'Failed' %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Failed</span>
                {% elif domain.verification_status == 'TemporaryFailure' %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">Temp Failure</span>
                {% else %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600">{{ domain.verification_status }}</span>
                {% endif %}

                <!-- DKIM Status -->
                {% if domain.dkim_status == 'Success' %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">DKIM</span>
                {% else %}
                    <span class="inline-flex px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600">DKIM {{ domain.dkim_status }}</span>
                {% endif %}

                <!-- Actions -->
                <button
                    hx-get="/api/domains/{{ domain.domain }}/status"
                    hx-target="#status-result-{{ domain.id }}"
                    hx-swap="innerHTML"
                    hx-indicator="#status-spinner-{{ domain.id }}"
                    class="text-blue-600 hover:text-blue-800 text-sm font-medium transition">
                    Check Status
                    <span id="status-spinner-{{ domain.id }}" class="htmx-indicator ml-1">...</span>
                </button>
                <button
                    hx-delete="/api/domains/{{ domain.domain }}"
                    hx-confirm="Remove {{ domain.domain }} from local database? (SES state will be preserved)"
                    hx-target="#domain-card-{{ domain.id }}"
                    hx-swap="outerHTML"
                    class="text-red-600 hover:text-red-800 text-sm font-medium transition">
                    Delete
                </button>
            </div>
        </div>

        <!-- Status refresh result -->
        <div id="status-result-{{ domain.id }}" class="mb-3"></div>

        <!-- DNS Records -->
        <div class="border-t border-gray-100 pt-4">
            <p class="text-xs font-medium text-gray-500 uppercase mb-2">Required DNS Records</p>
            <div class="space-y-2">
                <!-- TXT Record -->
                <div class="bg-gray-50 rounded p-3">
                    <div class="flex items-center justify-between">
                        <div>
                            <span class="inline-flex px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 mr-2">TXT</span>
                            <code class="text-xs text-gray-600">_amazonses.{{ domain.domain }}</code>
                        </div>
                        <button onclick="copyToClipboard('{{ domain.verification_token }}')"
                                class="text-xs text-gray-400 hover:text-gray-600 transition"
                                title="Copy value">
                            Copy
                        </button>
                    </div>
                    <div class="mt-1">
                        <code class="text-xs text-gray-800 break-all">{{ domain.verification_token }}</code>
                    </div>
                </div>

                <!-- DKIM CNAME Records -->
                {% for token in domain.dkim_tokens %}
                <div class="bg-gray-50 rounded p-3">
                    <div class="flex items-center justify-between">
                        <div>
                            <span class="inline-flex px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 mr-2">CNAME</span>
                            <code class="text-xs text-gray-600">{{ token }}._domainkey.{{ domain.domain }}</code>
                        </div>
                        <button onclick="copyToClipboard('{{ token }}.dkim.amazonses.com')"
                                class="text-xs text-gray-400 hover:text-gray-600 transition"
                                title="Copy value">
                            Copy
                        </button>
                    </div>
                    <div class="mt-1">
                        <code class="text-xs text-gray-800">{{ token }}.dkim.amazonses.com</code>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        {% if domain.verified_at %}
        <p class="text-xs text-gray-400 mt-3">Verified at {{ domain.verified_at.strftime('%Y-%m-%d %H:%M:%S UTC') }}</p>
        {% endif %}
    </div>
    {% else %}
    <div class="bg-white rounded-lg shadow p-12 text-center text-gray-500">
        No domains configured. Add a domain to get started.
    </div>
    {% endfor %}
</div>
